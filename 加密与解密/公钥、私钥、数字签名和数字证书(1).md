### 公私钥加解密
![](https://github.com/ashenone0917/image/blob/main/670ddf02812a4789aa12901770f015de.png)  

Bob有两把钥匙，一把叫公钥(public key)，一把叫私钥(private key)。

![](https://github.com/ashenone0917/image/blob/main/161989e5a64f4c0c8210912022f2f4ae.png)  

Bob的公钥可以公开供其他人使用，他只保留自己的私钥。公钥和私钥用来加解密数据，如果使用任意一把来加密数据，那么只有使用另外一把才能解密数据(公用和私钥都可以加解密数据)  

![](https://github.com/ashenone0917/image/blob/main/3eefdc51188b4fc09b3ad8735f712d37.png)  

Susan想给Bob写信，她可以使用Bob的公钥将内容加密后发送给Bob，Bob收到以后，使用私钥解密以便阅读内容。Bob的其他同事即使截获了Susan发送给Bob的信件，由于没有Bob的私钥，也无法解密，从而确保数据安全。以上就是使用公钥和私钥加解密的过程演示。  

多说一句，如果Bob给Susan回信，如何保证数据安全呢？它可以使用Susan的公钥加密消息后发给Susan，Susan使用自己的私钥解密后阅读。所以保护好自己的私钥非常重要。

### 数字签名
现在Bob决定给Pat写一封信，信件的内容不用加密，但是要保证Pat收到信件后，能够确认信件确实是Bob发出的，而不是别人冒充Bob发给Pat的，应该怎么做？  

![](https://github.com/ashenone0917/image/blob/main/f1e289bf1eae47b099b5e75a9f2f6caf.png)  

Bob将信件通过hash软件计算一下，得到一串信息摘要(或hash值)。这一过程能够保证两点：
1. 过程不可逆。即不能通过消息摘要计算出信件的内容。
2. 消息摘要不会重复。即如果信件有任何改动，再次hash计算出的消息摘要一定不会和改动前的消息摘要一致。

![](https://github.com/ashenone0917/image/blob/main/f88b85cfdb4244e882bd83775aa061d1.png)  

然后，Bob使用自己的私钥，将消息摘要加密。加密后的记过，我们称之为“数字签名”。现在，Bob就可以将信件连同数字签名一起发给Pat。

![](https://github.com/ashenone0917/image/blob/main/638335cf4bcc4a789d6fac58585c3e14.png)

Pat收到信件以后，会做2件事：①使用Bob的公钥将数字签名解密，如果顺利解密，说明的确是Bob签发的数字签名，不是别人签发的，因为Bob的私钥没有公开。②Pat使用hash软件对信件再次进行hash计算，和解密数字签名得到的消息摘要对比，如果一致，说明信件没有篡改，确实是Bob发出的。这就是数字签名的过程。它能够确保签名人发出的消息不被篡改，也能证明的确是签名人发出的消息。

ok，一切看上去是那么的完美，使用公钥私钥，即能加解密消息，又可以数字签名。说了那么多，还没有提到文章的主题----数字证书（不要和数字签名搞混了）。

### 数字证书
先来做一道CISP的试题：

那类人对单位的信息安全威胁最大：a.高层领导  b.信息主管  c.安全管理员  d.心怀不满的员工

三长一短选最短，三短一长选最长，so答案就是d，也是我们下面引入的主角，Doug，our disgruntled employee。

Doug要欺骗Pat，冒充Bob给Pat写信，他应该怎么做的？既然Bob的公钥是公开的，Doug可以冒充Bob，将他自己的公钥发给Pat，让Pat误认为收到的公钥就是Bob的，然后就可以冒充Bob给Pat发消息了(这里我们只谈理论，不谈具体实现方式)。所以问题的核心就是，如何确保公钥不被冒充？

使用数字证书可以确保公钥不被冒充。数字证书是经过权威机构(CA)认证的公钥，通过查看数字证书，可以知道该证书是由那家权威机构签发的，证书使用人信息，使用人的公钥。它有以下特点：

1. 由专门的机构签发的数字证书才安全有效
2. 签发数字证书是收费的
3. 不会被冒充，安全可信
4. 数字证书有使用期限，过了使用期限，证书变为不可用。CA也可以在试用期内 ，对证书进行作废操作。

数字证书的内容：
数字证书的格式普遍采用的是X.509V3国际标准，一个标准的X509数字证书包含以下一些内容：
1. 证书的版本信息
2. 证书的序列号，每个证书都有一个唯一的证书序列号
3. 证书所使用的签名算法
4. 整数的发行机构名称，命名规则一般采用X.500格式
5. 证书的有效期，通用的证书一般采用UTC时间格式
6. 证书所有人的名称，名称规则一般采用X.500格式
7. 证书所有人的公钥
8. 证书发行者对证书的签名

![](https://github.com/ashenone0917/image/blob/main/ade6cd34320e4fc2bd30977593e44808%20(1).png)

CA的公钥已经集成到操作系统中了。如上图。

生成数字证书的流程的如下：

1. 持有人将公钥以及身份信息发送给权威机构。
2. 权威机构负责对持有人的身份进行验证，确保公钥和持有人的信息准确无误。
3. 权威机构使用自己私钥对持有人公钥进行数字签名，生成数字证书。
4. 为了确保证书不被篡改，权威机构对数字证书进行hash计算(指纹算法)，生成摘要(指纹)，使用自己的私钥对摘要进行数字签名，放到数字证书中。
5. 对持有人收费。

[http://www.youdzone.com/signature.html]()



